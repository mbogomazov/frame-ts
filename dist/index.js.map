{"mappings":"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","sources":["src/index.ts","src/create-functions.ts","src/types.ts","src/reactivity/index.ts","src/template-engine/index.ts","src/state-manager/index.ts"],"sourcesContent":["export * from './create-functions';\nexport * from './reactivity/index';\nexport * from './types';\nexport * from './template-engine';\nexport * from './state-manager';\n","import {\n    CompNode,\n    Component,\n    EffectTags,\n    FiberNode,\n    NodeTypes,\n    PropsType,\n} from './types';\n\n/**\n * Creating node containing only text\n * @param {string} text - text content for HTMLElement\n * @return {FiberNode} text node\n */\nexport function createTextNode(text: string): FiberNode {\n    const textNode: FiberNode = {\n        type: NodeTypes.textNode,\n        effectTag: EffectTags.create,\n        value: text,\n        children: [],\n    };\n    return textNode;\n}\n\n/**\n * Creating node containing only text\n * @param {Function} func - text content for HTMLElement\n * @return {FiberNode} text node\n */\nexport function createFuncNode(func: Function): FiberNode {\n    const functNode: FiberNode = {\n        type: NodeTypes.funcNode,\n        effectTag: EffectTags.create,\n        value: func,\n        children: [],\n    };\n    return functNode;\n}\n\n// eslint-disable-next-line require-jsdoc\nexport function createComponentNode(node: CompNode): FiberNode {\n    const functNode: FiberNode = {\n        type: NodeTypes.compNode,\n        effectTag: EffectTags.create,\n        value: node.compConstructor,\n        props: node.props,\n        children: [],\n    };\n    return functNode;\n}\n\n/**\n *\n * @param {NodeTypes} type - type of node\n * @param {object} props - node properties\n * @param {Function} componentConstructor - constructor of class extending Component\n * @param {FiberNode[]} children - node children\n * @return {FiberNode} - node instance\n */\nexport function createNode(\n    type: NodeTypes | string,\n    props: PropsType,\n    componentConstructor?: typeof Component,\n    ...children: (FiberNode | string | Function | CompNode)[]\n): FiberNode {\n    const node: FiberNode = {\n        type,\n        props,\n        value: componentConstructor,\n        effectTag: EffectTags.create,\n        children: children.map(el => {\n            if (typeof el === 'string') {\n                return createTextNode(el);\n            } else if (typeof el === 'function') {\n                return createFuncNode(el);\n            } else if (typeof el === 'object' && 'compConstructor' in el) {\n                return createComponentNode(el);\n            } else {\n                return el;\n            }\n        }),\n    };\n    return node;\n}\n\n/**\n * Create DOM object from Node interface instance\n * @param {FiberNode} node - fiber node instance\n * @return {HTMLElement} domNode\n */\nexport function createDomNode(node: FiberNode): HTMLElement | Text {\n    const joinedProps = {...node.props, ...getParentClassComponentProps(node)};\n    if (node.type === NodeTypes.textNode && node.value) {\n        const textDomNode = document.createTextNode(node.value as string);\n        return textDomNode;\n    }\n    if (\n        (node.type === NodeTypes.funcNode ||\n            node.type === NodeTypes.compNode) &&\n        node.value\n    ) {\n        const computedValue = (node.value as Function)(joinedProps);\n        // TODO: if computedValue contains component or arrays of component\n        // add them to parent node\n\n        const computedTextDomNode = document.createTextNode(computedValue);\n        return computedTextDomNode;\n    }\n\n    const domNode = document.createElement(node.type);\n    if (node.props) {\n        Object.entries(node.props).map(([propName, propValue]) => {\n            // TODO: fix it\n            if (typeof propValue === 'string') {\n                (domNode as any)[propName] = propValue;\n            }\n            if (typeof propValue === 'function') {\n                (domNode as any)[propName] = () => propValue(joinedProps);\n            }\n        });\n    }\n\n    return domNode;\n}\n\n// eslint-disable-next-line require-jsdoc\nexport function getParentClassComponentProps(node: FiberNode) {\n    if (node.parentComponent) {\n        return node.parentComponent.props;\n    } else {\n        return node.props;\n    }\n    // let parentNode: FiberNode | undefined = node.parent;\n    // let parentComponentProps: PropsType = {};\n    // console.log(parentNode);\n    // while (parentNode && Object.keys(parentNode).length) {\n    //     if (\n    //         parentNode.parentComponentProps &&\n    //         Object.keys(parentNode.parentComponentProps).length\n    //     ) {\n    //         parentComponentProps = parentNode.parentComponentProps;\n    //         break;\n    //     }\n    //     parentNode = parentNode.parent;\n    // }\n    // return parentComponentProps;\n}\n","/* eslint-disable require-jsdoc */\nexport enum NodeTypes {\n    // eslint-disable-next-line no-unused-vars\n    textNode = 'TEXT_NODE',\n    // eslint-disable-next-line no-unused-vars\n    unitOfWork = 'UNIT_OF_WORK',\n    // eslint-disable-next-line no-unused-vars\n    funcNode = 'FUNC_NODE',\n    // eslint-disable-next-line no-unused-vars\n    compNode = 'COMP_NODE',\n}\n\nexport enum EffectTags {\n    // eslint-disable-next-line no-unused-vars\n    update = 'UPDATE',\n    // eslint-disable-next-line no-unused-vars\n    delete = 'DELETE',\n    // eslint-disable-next-line no-unused-vars\n    create = 'CREATE',\n}\n\n// how it looks like https://pomb.us/static/a88a3ec01855349c14302f6da28e2b0c/ac667/fiber1.png\nexport type FiberNode = {\n    // TODO: fix type\n    type: NodeTypes | string;\n    children: FiberNode[];\n    effectTag?: EffectTags;\n    dom?: HTMLElement | Text;\n    props?: PropsType;\n    parent?: FiberNode;\n    firstChild?: FiberNode;\n    sibling?: FiberNode;\n    previousCommittedRootNode?: FiberNode;\n    value?: string | Function;\n    hooks?: any[];\n    isClassComponent?: boolean;\n    parentComponent?: FiberNode;\n};\n\nexport type PropsType = {[key: string]: any};\nexport type GlobalStateType = {\n    nodesToDeleteFromDom: FiberNode[];\n    // componentProps: PropsType\n    uncommitedRootNode: FiberNode | undefined;\n    currentRootNode: FiberNode | undefined;\n    wipNode: FiberNode | undefined;\n    hookIndex: number;\n    addNodeToQueue: Function;\n};\n\nexport type CompNode = {\n    compConstructor: Function;\n    props: PropsType;\n};\n\n// eslint-disable-next-line require-jsdoc\nexport class Component {\n    template!: string;\n    render(): FiberNode {\n        return {\n            type: '',\n            children: [],\n        };\n    }\n\n    constructor(public parentProps?: PropsType) {}\n}\n","import {createDomNode, getParentClassComponentProps} from '../create-functions';\nimport {\n    Component,\n    EffectTags,\n    FiberNode,\n    GlobalStateType,\n    NodeTypes,\n    PropsType,\n} from '../types';\n\nconst queue: FiberNode[] = [];\nconst nodesToDeleteFromDom: FiberNode[] = [];\nlet componentProps: PropsType = {};\nlet isWorking = false;\nconst globalState: GlobalStateType = {\n    nodesToDeleteFromDom: nodesToDeleteFromDom,\n    uncommitedRootNode: undefined,\n    currentRootNode: undefined,\n    wipNode: undefined,\n    hookIndex: 0,\n    addNodeToQueue: (node: FiberNode) => {\n        queue.push(node);\n        console.log('called');\n        if (!isWorking) requestIdleCallback(runJobQueue);\n    },\n};\n\n// eslint-disable-next-line require-jsdoc\nfunction render(element: FiberNode, container: HTMLElement, props: PropsType) {\n    if (\n        element.value &&\n        typeof element.value === 'function' &&\n        element.value.prototype instanceof Component\n    ) {\n        globalState.uncommitedRootNode = {\n            // TODO: fix it\n            type: NodeTypes.unitOfWork,\n            dom: container,\n            effectTag: EffectTags.create,\n            children: [\n                {\n                    type: element.type,\n                    effectTag: EffectTags.create,\n                    children: element.children,\n                    value: element.value,\n                    props: element.props,\n                    isClassComponent: true,\n                },\n            ],\n            previousCommittedRootNode: globalState.currentRootNode,\n        };\n    } else {\n        globalState.uncommitedRootNode = {\n            // TODO: fix it\n            type: NodeTypes.unitOfWork,\n            dom: container,\n            value: element.value,\n            props: element.props,\n            effectTag: EffectTags.create,\n            children: element.children,\n            previousCommittedRootNode: globalState.currentRootNode,\n        };\n    }\n    globalState.uncommitedRootNode.parentComponent =\n        globalState.uncommitedRootNode;\n    componentProps = props;\n    componentProps.globalState = globalState;\n    const nextNode = globalState.uncommitedRootNode;\n    queue.push(nextNode);\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction workWithDom(node: FiberNode | undefined) {\n    if (!node || !node.parent) {\n        return;\n    }\n\n    let domParentNode = node.parent;\n    while (!domParentNode.dom) {\n        domParentNode = domParentNode.parent!;\n    }\n    const domParent = domParentNode.dom;\n\n    if (node.effectTag === EffectTags.create && node.dom) {\n        // TODO: check it\n        domParent.appendChild(node.dom);\n    }\n    if (node.effectTag === EffectTags.delete) {\n        commitDeletion(node, domParent);\n    }\n    if (node.effectTag === EffectTags.update) {\n        updateDomNode(node);\n    }\n    workWithDom(node.firstChild);\n    workWithDom(node.sibling);\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction commitDeletion(node: FiberNode, domParent: HTMLElement | Text) {\n    if (node.dom) {\n        domParent.removeChild(node.dom);\n    } else {\n        commitDeletion(node.firstChild!, domParent);\n    }\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction updateDomNode(node: FiberNode) {\n    if (node.type === NodeTypes.funcNode && !node.isClassComponent) {\n        const joinedProps = {\n            ...node.props,\n            ...getParentClassComponentProps(node),\n        };\n        const computedValue = (node.value as Function)(joinedProps);\n        if (\n            (typeof computedValue === 'string' ||\n                typeof computedValue === 'number') &&\n            node.dom &&\n            'data' in node.dom\n        ) {\n            if (computedValue !== node.dom.data) {\n                const newDomNode = document.createTextNode(\n                    computedValue.toString()\n                );\n                node.parent!.dom!.replaceChild(newDomNode, node.dom);\n                node.dom = newDomNode;\n            }\n        }\n    }\n\n    const isEvent = (key: string) => key.startsWith('on');\n    const isProperty = (key: string) => key !== 'children';\n    const isNew =\n        (prev: PropsType | undefined, next: PropsType | undefined) =>\n        (key: string) =>\n            (prev && next && prev[key] !== next[key]) || (!prev && next);\n    const isGone = (next: PropsType | undefined) => (key: string) =>\n        (next && !(key in next)) || !next;\n\n    const prevProps = node.previousCommittedRootNode!.props;\n    const currentProps = node.props;\n\n    if (prevProps) {\n        Object.keys(prevProps)\n            .filter(isEvent)\n            .filter(isNew(prevProps, currentProps))\n            .forEach(name => {\n                const eventType = name.toLowerCase().substring(2);\n                node.dom!.removeEventListener(eventType, prevProps[name]);\n            });\n\n        Object.keys(prevProps)\n            .filter(isProperty)\n            .filter(isGone(currentProps))\n            .forEach(propName => ((node.dom as any)[propName] = ''));\n    }\n    if (currentProps) {\n        Object.keys(currentProps)\n            .filter(isProperty)\n            .filter(isNew(prevProps, currentProps))\n            .forEach(propName => {\n                if (typeof currentProps[propName] === 'string') {\n                    (node.dom as any)[propName] = currentProps[propName];\n                }\n                if (typeof currentProps[propName] === 'function') {\n                    const joinedProps = {\n                        ...node.props,\n                        ...getParentClassComponentProps(node),\n                    };\n                    if (node.dom) {\n                        (node.dom as any)[propName] = (\n                            currentProps[propName] as Function\n                        )(joinedProps);\n                    }\n                }\n            });\n\n        Object.keys(currentProps)\n            .filter(isEvent)\n            .filter(isNew(prevProps, currentProps))\n            .forEach(name => {\n                const eventType = name.toLowerCase().substring(2);\n                node.dom!.addEventListener(eventType, currentProps[name]);\n            });\n    }\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction runJobQueue(deadline: IdleDeadline) {\n    let canRender = true;\n    while (canRender && queue.length > 0) {\n        isWorking = true;\n\n        const currentNode = queue[0];\n        queue.shift();\n        const nextNode = applyJob(currentNode);\n        if (nextNode) {\n            queue.push(nextNode);\n        }\n        canRender = deadline.timeRemaining() < 1;\n    }\n\n    if (queue.length) {\n        requestIdleCallback(runJobQueue);\n    } else if (globalState.uncommitedRootNode) {\n        isWorking = false;\n        nodesToDeleteFromDom.forEach(workWithDom);\n\n        // we need add root node to DOM separately of creating DOM element\n        // because it can take more time that we want\n        // console.log(globalState.uncommitedRootNode.hooks);\n        if (globalState.uncommitedRootNode.firstChild) {\n            workWithDom(globalState.uncommitedRootNode.firstChild);\n        }\n        let mainRootNode = globalState.uncommitedRootNode;\n        while (mainRootNode.parent && Object.keys(mainRootNode.parent).length) {\n            mainRootNode = mainRootNode.parent;\n        }\n        globalState.currentRootNode = mainRootNode;\n        globalState.uncommitedRootNode = undefined;\n    }\n}\n\n// how it works: https://pomb.us/static/19c304dcb3824b14722691ded539ecdb/ac667/fiber4.png\n// eslint-disable-next-line require-jsdoc\nfunction applyJob(node: FiberNode) {\n    const isClassComponent =\n        node.value &&\n        typeof node.value === 'function' &&\n        node.value.prototype instanceof Component;\n\n    if (isClassComponent) {\n        updateClassComponent(node);\n    } else {\n        updateHostComponent(node);\n    }\n\n    // if node has a child we should apply job to it\n    if (node.firstChild) {\n        return node.firstChild;\n    }\n\n    // else if node has a siblind we should apply job to it\n    // if node doesn't have a sibling nor child do nothing\n    let nextNode = node;\n    while (nextNode) {\n        if (nextNode.sibling) {\n            return nextNode.sibling;\n        }\n        // TODO: fix it\n        nextNode = nextNode.parent!;\n    }\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction updateHostComponent(node: FiberNode) {\n    if (!node.dom) {\n        node.dom = createDomNode(node);\n    }\n    updateChildrenNode(node, node.children);\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction updateClassComponent(node: FiberNode) {\n    globalState.hookIndex = 0;\n    globalState.wipNode = node;\n    globalState.wipNode.hooks =\n        globalState.wipNode.previousCommittedRootNode &&\n        globalState.wipNode.previousCommittedRootNode.hooks &&\n        Array.isArray(globalState.wipNode.previousCommittedRootNode.hooks)\n            ? [...globalState.wipNode.previousCommittedRootNode.hooks]\n            : [];\n    node.props = {...node.props, globalState};\n    const component = new (node.value! as typeof Component)(node.props);\n    node.children = node.children.length ? node.children : [component.render()];\n    node.isClassComponent = true;\n    node.parentComponent = node;\n    updateChildrenNode(node, node.children);\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction updateChildrenNode(node: FiberNode, children: FiberNode[]) {\n    let index = 0;\n    let prevSibling: FiberNode | undefined;\n    let committedNode: FiberNode | undefined =\n        node.previousCommittedRootNode?.firstChild ?? undefined;\n\n    while (index < children.length || committedNode) {\n        let childNode = children[index];\n\n        if (committedNode && committedNode.type === childNode.type) {\n            // update node props\n            childNode = {\n                type: childNode.type,\n                effectTag: EffectTags.update,\n                props: childNode.props,\n                children: childNode.children,\n                firstChild: childNode.firstChild,\n                sibling: childNode.sibling,\n                value: childNode.value,\n                dom: committedNode.dom,\n                previousCommittedRootNode: committedNode,\n                parent: node,\n                isClassComponent: childNode.isClassComponent,\n                hooks: childNode.hooks,\n            };\n            childNode.parentComponent =\n                childNode.parent && childNode.parent.isClassComponent\n                    ? childNode.parent\n                    : childNode.parent\n                    ? childNode.parent.parentComponent\n                    : childNode;\n        }\n        if (committedNode && committedNode.type !== childNode.type) {\n            // delete old node and add new node\n            committedNode.effectTag = EffectTags.delete;\n            nodesToDeleteFromDom.push(committedNode);\n            // TODO: check it\n            childNode = {\n                type: childNode.type,\n                effectTag: EffectTags.create,\n                props: childNode.props,\n                children: childNode.children,\n                value: childNode.value,\n                parent: node,\n                isClassComponent: childNode.isClassComponent,\n                firstChild: childNode.firstChild,\n                sibling: childNode.sibling,\n                hooks: childNode.hooks,\n            };\n            childNode.parentComponent =\n                childNode.parent && childNode.parent.isClassComponent\n                    ? childNode.parent\n                    : childNode.parent\n                    ? childNode.parent.parentComponent\n                    : childNode;\n        }\n        if (!committedNode && childNode) {\n            // add new node\n            childNode = {\n                type: childNode.type,\n                effectTag: EffectTags.create,\n                props: childNode.props,\n                children: childNode.children,\n                value: childNode.value,\n                parent: node,\n                hooks: childNode.hooks,\n                isClassComponent: childNode.isClassComponent,\n            };\n            childNode.parentComponent =\n                childNode.parent && childNode.parent.isClassComponent\n                    ? childNode.parent\n                    : childNode.parent\n                    ? childNode.parent.parentComponent\n                    : childNode;\n        }\n\n        if (committedNode) {\n            committedNode = committedNode.sibling;\n        }\n\n        if (childNode.type)\n            if (prevSibling) {\n                prevSibling!.sibling = childNode;\n            } else {\n                node.firstChild = childNode;\n            }\n\n        prevSibling = childNode;\n        children[index] = childNode;\n        index++;\n    }\n}\n\n// eslint-disable-next-line require-jsdoc\nexport function init(\n    element: FiberNode,\n    containerSelector: string,\n    props: PropsType\n) {\n    const domContainer: HTMLElement | null =\n        document.querySelector(containerSelector);\n    if (domContainer) {\n        render(element, domContainer, props);\n        requestIdleCallback(runJobQueue);\n    } else {\n        throw new Error(\n            `Can't find element with selector ${containerSelector}`\n        );\n    }\n}\n","// import AppComponent from '../app'\nimport {createNode} from '../create-functions';\nimport {CompNode, Component, FiberNode, PropsType} from '../types';\n\ntype TagNodeType = {\n    type: 'self-closing' | 'element' | 'textValue' | 'funcValue' | 'component';\n    name: string;\n    length: number;\n    value: string | Function;\n    props: PropsType;\n    children: TagNodeType[];\n    isClosing?: boolean;\n};\n\n// eslint-disable-next-line require-jsdoc\nexport default function parseElement(\n    template: string,\n    lastOpenedTagName: string = '',\n    imports?: {[key: string]: typeof Component}\n) {\n    const openingTag = /^\\n*?[ \\t]*?<(\\w+)/;\n    const endOpeningTag = />/;\n\n    const node: TagNodeType = {\n        type: 'element',\n        name: '',\n        length: 0,\n        value: '',\n        props: {},\n        children: [],\n    };\n    let match = template.match(openingTag);\n    const closingTag = new RegExp(`[ \\t]*?</${lastOpenedTagName}>`);\n\n    if (!match) {\n        // if no opening tag we should find closing tag\n        // and between them parse value\n        match = template.match(closingTag);\n        if (!match) {\n            throw new Error('parsing error: no closing tag');\n        }\n        const nodeValue = parseValue(template.slice(0, match.index!).trim());\n        if (nodeValue.length === 0) {\n            node.value = '';\n        } else {\n            for (const childNodeContent of nodeValue) {\n                if (typeof childNodeContent === 'string') {\n                    node.children.push({\n                        type: 'textValue',\n                        name: '',\n                        value: childNodeContent,\n                        props: {},\n                        length: childNodeContent.length,\n                        children: [],\n                    });\n                } else {\n                    node.children.push({\n                        type: 'funcValue',\n                        name: '',\n                        value: childNodeContent,\n                        props: {},\n                        length: NaN,\n                        children: [],\n                    });\n                }\n            }\n        }\n        node.length = match.index! + match[0].length;\n        node.type = 'element';\n        node.isClosing = true;\n\n        return node;\n    }\n\n    let nodeLength = match.index! + match[0].length;\n    node.name = match[1];\n\n    template = template.slice(match.index! + match[0].length);\n\n    // find the end of opened tag\n    match = template.match(endOpeningTag);\n    if (!match) {\n        throw new Error('parsing error: no end of opening tag');\n    }\n\n    let templateCopy = template;\n    let cuttedSymbols = 0;\n    // check if we found '=>' in arrow function\n    while (match && templateCopy[match.index! - 1] === '=') {\n        templateCopy = templateCopy.slice(match!.index! + 1);\n        cuttedSymbols += match!.index! + 1;\n        match = templateCopy.match(endOpeningTag);\n    }\n\n    if (!match) {\n        throw new Error('parsing error: no end of opening tag');\n    }\n\n    nodeLength += match.index! + match[0].length + cuttedSymbols;\n    const propsStr = template.slice(0, match.index! + cuttedSymbols);\n\n    node.props = parseProps(propsStr);\n\n    // if self-closing tag\n    if (\n        template.slice(\n            match.index! + cuttedSymbols - 1,\n            match.index! + cuttedSymbols + 1\n        ) === '/>'\n    ) {\n        node.type = 'self-closing';\n        if (imports && node.name in imports) {\n            node.value = imports[node.name];\n            node.type = 'component';\n        }\n        node.isClosing = true;\n        node.length = nodeLength;\n        return node;\n    }\n\n    // nodeLength += propsStr.length\n    template = template.slice(match.index! + cuttedSymbols + 1);\n\n    let childNode = parseElement(template, node.name, imports);\n    while (!childNode.isClosing) {\n        template = template.slice(childNode.length);\n        node.children.push(childNode);\n        nodeLength += childNode.length;\n        childNode = parseElement(template, node.name, imports);\n    }\n\n    nodeLength += childNode.length;\n    if (childNode.value.length) {\n        node.children.push(childNode);\n    } else if (childNode.children.length) {\n        node.children.push(...childNode.children);\n    }\n    node.length = nodeLength;\n    return node;\n}\n\n// TODO: write it\n// (string | FiberNode)[]\n// eslint-disable-next-line require-jsdoc\nfunction parseValue(str: string) {\n    const curlyBracets = /{[^}]*}/;\n    let match = str.match(curlyBracets);\n    const children: (string | Function)[] = [];\n    while (match) {\n        const prevTextNode = str.slice(0, match.index!);\n        if (prevTextNode.length) {\n            children.push(prevTextNode);\n        }\n        const funcNodeStr = str\n            .slice(match.index! + 1, match.index! + match[0].length - 1)\n            .trim();\n        const funcNode = createFuncValue(funcNodeStr);\n        children.push(funcNode);\n        str = str.slice(match.index! + match[0].length);\n        match = str.match(curlyBracets);\n    }\n    if (str.length) {\n        children.push(str);\n    }\n    return children;\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction parseProps(str: string) {\n    const props: PropsType = {};\n    // regex to get attributes from tag\n    const matchNextProp = () =>\n        str.match(/ *\\w+=\\\".+?(?=\")\"/) || str.match(/ *\\w+/);\n\n    let match = matchNextProp();\n    if (!match) {\n        return props;\n    }\n\n    while (match) {\n        const propStr = match[0];\n        let [propKey, ...propValues] = propStr.split('=');\n        propKey = propKey.trim();\n        let propValue: string | boolean | Function = propValues.join('=');\n        propValue =\n            typeof propValue === 'string' && propValue.length\n                ? propValue.slice(1, -1)\n                : true;\n        const curlyBracets = /{.*}/;\n\n        if (typeof propValue === 'string') {\n            const bracetsMatch = propValue.match(curlyBracets);\n            if (bracetsMatch) {\n                propValue = createFuncValue(bracetsMatch[0].slice(1, -1));\n            }\n        }\n        props[propKey] = propValue;\n        str =\n            str.slice(0, match.index) +\n            str.slice(match.index! + propStr.length);\n        match = matchNextProp();\n    }\n\n    return props;\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction createFuncValue(str: string) {\n    return new Function('props', `return ${str}`);\n}\n\n// eslint-disable-next-line require-jsdoc\nfunction convertTagNodeToFiberNode(tagNode: TagNodeType): FiberNode {\n    // if tag node has a value it means that node is component\n    let componentConstructor: typeof Component | undefined;\n    if (tagNode.type === 'component' && tagNode.value) {\n        componentConstructor = tagNode.value as typeof Component;\n    }\n    const convertedNode = {\n        type: tagNode.name,\n        props: tagNode.props,\n        value: componentConstructor,\n        children: tagNode.children.map(node =>\n            ['funcValue', 'textValue'].includes(node.type)\n                ? node.value\n                : node.type === 'component'\n                ? ({compConstructor: node.value, props: node.props} as CompNode)\n                : convertTagNodeToFiberNode(node)\n        ),\n    };\n    return createNode(\n        convertedNode.type,\n        convertedNode.props,\n        componentConstructor,\n        ...convertedNode.children\n    );\n}\n\n// example of template\n// const templateStr = `<template id=\"app\" visible>\n//     <div>\n//         <h1>Hello, {props.name} {props.surname}, nice to meet you</h1>\n//         <div>\n//             <div>\n//                 <ul>\n//                     <li>1</li>\n//                     <li>2</li>\n//                     <li>3</li>\n//                     <li>4</li>\n//                 </ul>\n//             </div>\n//         </div>\n//     </div>\n//     <a href=\"https://google.com\">\n//         <img src=\"john.png\" alt=\"John's face\"/>\n//     </a>\n// </template>\n// `\n\n// eslint-disable-next-line require-jsdoc\nexport function parseTemplate(\n    template: string,\n    imports?: {[key: string]: typeof Component}\n): FiberNode {\n    const rootNode = parseElement(template, '', imports);\n    const rootFiberNode = convertTagNodeToFiberNode(rootNode);\n    return rootFiberNode;\n}\n\n// const templateStr = `\n// <div><App props=\"{props}\" /></div>\n// `\n\n// console.log(\n//     parseTemplate(templateStr, {\n//         App: AppComponent,\n//     }).children[0].value\n// )\n","import {FiberNode, GlobalStateType} from '../types';\n\n// eslint-disable-next-line require-jsdoc\nexport function useState(initial: any, globalState: GlobalStateType) {\n    const actionsQueue: Function[] = [];\n    const oldHook =\n        globalState.wipNode!.previousCommittedRootNode &&\n        globalState.wipNode!.previousCommittedRootNode.hooks &&\n        globalState.wipNode!.previousCommittedRootNode.hooks[\n            globalState.hookIndex\n        ];\n\n    const hook = {\n        state: oldHook ? oldHook.state : initial,\n        queue: actionsQueue,\n    };\n\n    const actions = oldHook ? oldHook.queue : [];\n    actions.forEach((action: Function) => {\n        hook.state = action(hook.state);\n    });\n\n    const setState = (action: Function) => {\n        hook.queue.push(action);\n        globalState.uncommitedRootNode = {\n            type: globalState.wipNode!.type,\n            children: globalState.wipNode!.children,\n            dom: globalState.wipNode!.dom,\n            props: globalState.wipNode!.props,\n            value: globalState.wipNode!.value,\n            previousCommittedRootNode: globalState.wipNode!,\n            parent: globalState.wipNode!.parent,\n            firstChild: globalState.wipNode!.firstChild,\n            parentComponent: globalState.wipNode!.parentComponent,\n        };\n\n        globalState.addNodeToQueue(globalState.uncommitedRootNode as FiberNode);\n        globalState.nodesToDeleteFromDom = [];\n    };\n\n    globalState.wipNode!.hooks!.push(hook);\n    globalState.hookIndex++;\n    return [hook.state, setState];\n}\n"],"names":[],"version":3,"file":"index.js.map"}