function e(e,o){return Object.keys(o).forEach((function(t){"default"===t||"__esModule"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}})})),e}function o(e,o,t,n){Object.defineProperty(e,o,{get:t,set:n,enumerable:!0,configurable:!0})}var t={};o(t,"createTextNode",(()=>s)),o(t,"createFuncNode",(()=>c)),o(t,"createComponentNode",(()=>d)),o(t,"createNode",(()=>a)),o(t,"createDomNode",(()=>l)),o(t,"getParentClassComponentProps",(()=>m));var n={};let r,i;o(n,"NodeTypes",(()=>r)),o(n,"EffectTags",(()=>i)),o(n,"Component",(()=>p)),function(e){e.textNode="TEXT_NODE",e.unitOfWork="UNIT_OF_WORK",e.funcNode="FUNC_NODE",e.compNode="COMP_NODE"}(r||(r={})),function(e){e.update="UPDATE",e.delete="DELETE",e.create="CREATE"}(i||(i={}));class p{render(){return{type:"",children:[]}}constructor(e){this.parentProps=e}}function s(e){return{type:r.textNode,effectTag:i.create,value:e,children:[]}}function c(e){return{type:r.funcNode,effectTag:i.create,value:e,children:[]}}function d(e){return{type:r.compNode,effectTag:i.create,value:e.compConstructor,props:e.props,componentName:e.componentName,children:[]}}function a(e,o,t,n,...r){return{type:e,props:o,value:t,componentName:n,effectTag:i.create,children:r.map((e=>"string"==typeof e?s(e):"function"==typeof e?c(e):"object"==typeof e&&"componentName"in e&&e.componentName?d(e):e))}}function l(e){const o={...e.props,...m(e)};if(e.type===r.textNode&&e.value){return document.createTextNode(e.value)}if((e.type===r.funcNode||e.type===r.compNode)&&e.value){const t=e.value(o);return document.createTextNode(t)}const t=document.createElement(e.type);return e.props&&Object.entries(e.props).map((([e,n])=>{"string"==typeof n&&t.setAttribute(e,n),"function"==typeof n&&(t[e]=()=>n(o))})),t}function m(e){return e.parentComponent?e.parentComponent.props:e.props}var u={};o(u,"init",(()=>k));const f=[],h=[];let N,C={},g=!1;const y={nodesToDeleteFromDom:h,uncommitedRootNode:void 0,currentRootNode:void 0,wipNode:void 0,hookIndex:0,addNodeToQueue:e=>{f.push(e),g||requestIdleCallback(b)}};function v(e){if(!e||!e.parent)return;let o=e.parent;for(;!o.dom;)o=o.parent;const t=o.dom;e.effectTag===i.create&&e.dom&&t.appendChild(e.dom),e.effectTag===i.delete&&w(e,t),e.effectTag===i.update&&function(e){if(e.type===r.funcNode&&!e.isClassComponent){const o={...e.props,...m(e)},t=e.value(o);if(("string"==typeof t||"number"==typeof t)&&e.dom&&"data"in e.dom&&t!==e.dom.data){const o=document.createTextNode(t.toString());e.parent.dom.replaceChild(o,e.dom),e.dom=o}}const o=e=>e.startsWith("on"),t=e=>"children"!==e,n=(e,o)=>t=>e&&o&&e[t]!==o[t]||!e&&o,i=e=>o=>e&&!(o in e)||!e,p=e.previousCommittedRootNode.props,s=e.props;p&&(Object.keys(p).filter(o).filter(n(p,s)).forEach((o=>{const t=o.toLowerCase().substring(2);e.dom.removeEventListener(t,p[o])})),Object.keys(p).filter(t).filter(i(s)).forEach((o=>e.dom[o]="")));s&&(Object.keys(s).filter(t).filter(n(p,s)).forEach((o=>{if("string"==typeof s[o]&&(e.dom[o]=s[o]),"function"==typeof s[o]){const t={...e.props,...m(e)};e.dom&&(e.dom[o]=s[o](t)())}})),Object.keys(s).filter(o).filter(n(p,s)).forEach((o=>{const t=o.toLowerCase().substring(2);e.dom.addEventListener(t,s[o])})))}(e),v(e.firstChild),v(e.sibling)}function w(e,o){e.dom?o.removeChild(e.dom):w(e.firstChild,o)}function b(e){let o=!0;for(;o&&f.length>0;){g=!0;const t=f[0];f.shift();const n=x(t);n&&f.push(n),o=e.timeRemaining()<1}if(f.length)requestIdleCallback(b);else if(y.uncommitedRootNode){g=!1,h.forEach(v),y.uncommitedRootNode.firstChild&&v(y.uncommitedRootNode.firstChild);let e=y.uncommitedRootNode;for(;e.parent&&Object.keys(e.parent).length;)e=e.parent;y.currentRootNode=e,y.uncommitedRootNode=void 0,"none"===document.body.style.display&&(document.body.style.display="block",N.push("/"))}}function x(e){if(e.value&&"function"==typeof e.value&&e.value.prototype instanceof p?function(e){y.hookIndex=0,y.wipNode=e,y.wipNode.hooks=y.wipNode.previousCommittedRootNode&&y.wipNode.previousCommittedRootNode.hooks&&Array.isArray(y.wipNode.previousCommittedRootNode.hooks)?[...y.wipNode.previousCommittedRootNode.hooks]:[],e.props={...e.props,globalState:y};const o=new e.value(e.props);e.children=e.children.length?e.children:[o.render()],e.isClassComponent=!0,e.parentComponent=e,e.componentInstance=o,N&&Object.values(N.routes).includes(e.componentName)&&N.addComponentNode(e,e.componentName);R(e,e.children)}(e):function(e){e.dom||(e.dom=l(e));R(e,e.children)}(e),e.firstChild)return e.firstChild;let o=e;for(;o;){if(o.sibling)return o.sibling;o=o.parent}}function R(e,o){let t,n=0,r=e.previousCommittedRootNode?.firstChild??void 0;for(;n<o.length||r;){let p=o[n];r&&r.type===p.type&&(p={type:p.type,effectTag:i.update,props:p.props,children:p.children,firstChild:p.firstChild,sibling:p.sibling,value:p.value,dom:r.dom,previousCommittedRootNode:r,parent:e,isClassComponent:p.isClassComponent,hooks:p.hooks,componentInstance:p.componentInstance},p.parentComponent=p.parent&&p.parent.isClassComponent?p.parent:p.parent?p.parent.parentComponent:p),r&&r.type!==p.type&&(r.effectTag=i.delete,h.push(r),p={type:p.type,effectTag:i.create,props:p.props,children:p.children,value:p.value,parent:e,isClassComponent:p.isClassComponent,firstChild:p.firstChild,sibling:p.sibling,hooks:p.hooks,componentName:p.componentName,componentInstance:p.componentInstance},p.parentComponent=p.parent&&p.parent.isClassComponent?p.parent:p.parent?p.parent.parentComponent:p),!r&&p&&(p={type:p.type,effectTag:i.create,props:p.props,children:p.children,value:p.value,parent:e,hooks:p.hooks,isClassComponent:p.isClassComponent,componentName:p.componentName,componentInstance:p.componentInstance},p.parentComponent=p.parent&&p.parent.isClassComponent?p.parent:p.parent?p.parent.parentComponent:p),r&&(r=r.sibling),p.type&&(t?t.sibling=p:e.firstChild=p),t=p,o[n]=p,n++}}function k(e,o,t,n){const s=document.querySelector(o);if(n&&(N=n,document.body.style.display="none"),!s)throw new Error(`Can't find element with selector ${o}`);!function(e,o,t){e.value&&"function"==typeof e.value&&e.value.prototype instanceof p?y.uncommitedRootNode={type:r.unitOfWork,dom:o,effectTag:i.create,children:[{type:e.type,effectTag:i.create,children:e.children,value:e.value,props:e.props,componentName:e.componentName,isClassComponent:!0}],previousCommittedRootNode:y.currentRootNode}:y.uncommitedRootNode={type:r.unitOfWork,dom:o,value:e.value,props:{...t,...e.props},effectTag:i.create,children:e.children,previousCommittedRootNode:y.currentRootNode},y.uncommitedRootNode.parentComponent=y.uncommitedRootNode,C=t,C.globalState=y;const n=y.uncommitedRootNode;f.push(n)}(e,s,t),requestIdleCallback(b)}var T,E={};function O(e,o="",t){const n=/>/,r={type:"element",name:"",length:0,value:"",props:{},children:[]};let i=e.match(/^\n*?[ \t]*?<(\w+)/);const p=new RegExp(`[ \t]*?</${o}>`);if(!i){if(i=e.match(p),!i)throw new Error("parsing error: no closing tag");const o=function(e){const o=/{[^}]*}/;let t=e.match(o);const n=[];for(;t;){const r=e.slice(0,t.index);r.length&&n.push(r);const i=I(e.slice(t.index+1,t.index+t[0].length-1).trim());n.push(i),t=(e=e.slice(t.index+t[0].length)).match(o)}e.length&&n.push(e);return n}(e.slice(0,i.index).trim());if(0===o.length)r.value="";else for(const e of o)"string"==typeof e?r.children.push({type:"textValue",name:"",value:e,props:{},length:e.length,children:[]}):r.children.push({type:"funcValue",name:"",value:e,props:{},length:NaN,children:[]});return r.length=i.index+i[0].length,r.type="element",r.isClosing=!0,r}let s=i.index+i[0].length;if(r.name=i[1],i=(e=e.slice(i.index+i[0].length)).match(n),!i)throw new Error("parsing error: no end of opening tag");let c=e,d=0;for(;i&&"="===c[i.index-1];)c=c.slice(i.index+1),d+=i.index+1,i=c.match(n);if(!i)throw new Error("parsing error: no end of opening tag");s+=i.index+i[0].length+d;const a=e.slice(0,i.index+d);if(r.props=function(e){const o={},t=()=>e.match(/ *\w+=\".+?(?=")"/)||e.match(/ *\w+/);let n=t();if(!n)return o;for(;n;){const r=n[0];let[i,...p]=r.split("=");i=i.trim();let s=p.join("=");s="string"!=typeof s||!s.length||s.slice(1,-1);const c=/{.*}/;if("string"==typeof s){const e=s.match(c);e&&(s=I(e[0].slice(1,-1)))}o[i]=s,e=e.slice(0,n.index)+e.slice(n.index+r.length),n=t()}return o}(a),"/>"===e.slice(i.index+d-1,i.index+d+1))return r.type="self-closing",t&&r.name in t&&(r.value=t[r.name],r.type="component",r.componentName=r.name),r.isClosing=!0,r.length=s,r;let l=O(e=e.slice(i.index+d+1),r.name,t);for(;"element"!==l.type||!l.isClosing;)e=e.slice(l.length),r.children.push(l),s+=l.length,l=O(e,r.name,t);return s+=l.length,l.value.length?r.children.push(l):l.children.length&&r.children.push(...l.children),r.length=s,r}function I(e){return new Function("props",`return ${e}`)}function j(e){let o;"component"===e.type&&e.value&&(o=e.value);const t={type:e.name,props:e.props,value:o,componentName:e.componentName,children:e.children.map((e=>["funcValue","textValue"].includes(e.type)?e.value:"component"===e.type?{compConstructor:e.value,props:e.props,componentName:e.componentName}:j(e)))};return a(t.type,t.props,o,t.componentName,...t.children)}T=E,Object.defineProperty(T,"__esModule",{value:!0,configurable:!0}),o(E,"default",(()=>O)),o(E,"parseTemplate",(()=>D));function D(e,o){return j(O(e,"",o))}console.log(D('<div>\n    <p>Hello {props.name}</p>\n    <img src="{props.imageUrl}" />\n</div>\n').children[1].props.src({imageUrl:"url"}));var L={};function P(e,o){const t=o.wipNode.previousCommittedRootNode&&o.wipNode.previousCommittedRootNode.hooks&&o.wipNode.previousCommittedRootNode.hooks[o.hookIndex],n={state:t?t.state:e,queue:[]};(t?t.queue:[]).forEach((e=>{n.state=e(n.state)}));return o.wipNode.hooks.push(n),o.hookIndex++,[n.state,e=>{n.queue.push(e),o.uncommitedRootNode={type:o.wipNode.type,children:o.wipNode.children,dom:o.wipNode.dom,props:o.wipNode.props,value:o.wipNode.value,previousCommittedRootNode:o.wipNode,parent:o.wipNode.parent,firstChild:o.wipNode.firstChild,parentComponent:o.wipNode.parentComponent},o.addNodeToQueue(o.uncommitedRootNode),o.nodesToDeleteFromDom=[]}]}o(L,"useState",(()=>P));var _={};o(_,"Router",(()=>M));class M{routes={};componentNodes={};constructor(e){window.addEventListener("popstate",(e=>{const o=e.state.routeLink;this.showMainComponent(o)})),this.routes=e}push(e){window.history.pushState({routeLink:e},e,e),this.showMainComponent(e)}addComponentNode(e,o){this.componentNodes[o]=e}showMainComponent(e){const o=this.routes[e];for(const e of this.componentNodes[o].children)e.dom instanceof HTMLElement&&(e.dom.style.display="block");for(const e of Object.keys(this.componentNodes))if(e!==o)for(const o of this.componentNodes[e].children)o.dom instanceof HTMLElement&&(o.dom.style.display="none")}}e(module.exports,t),e(module.exports,u),e(module.exports,n),e(module.exports,E),e(module.exports,L),e(module.exports,_);